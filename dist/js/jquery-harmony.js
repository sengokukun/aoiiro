!function(t){var e,n=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))},i=function(){var t=function(t){return"#"===t.charAt(0)?t.substring(1,7):t};return{toR:function(e){return parseInt(t(e).substring(0,2),16)},toG:function(e){return parseInt(t(e).substring(2,4),16)},toB:function(e){return parseInt(t(e).substring(4,6),16)},isHex:function(t){return"#"===t.charAt(0)}}}();!function(n,i,r){var o,s={},a=n.innerWidth,h=n.innerHeight;o=function(t,e){return t in s?new s[t](e):new s.ribbon(e)},function(){function t(t){var e,n=[];for(e=1;e<arguments.length;e++)n.push(arguments[e]);return function(){return t.apply(this,n)}}s.ribbon=function(t){this.init(t)},s.ribbon.prototype={context:null,mouseX:null,mouseY:null,painters:null,interval:null,init:function(e){this.context=e,this.context.lineWidth=1,this.context.globalCompositeOperation="source-over",this.mouseX=a/2,this.mouseY=h/2,this.painters=new Array;for(var n=0;n<50;n++)this.painters.push({dx:a/2,dy:h/2,ax:0,ay:0,div:.1,ease:.2*Math.random()+.6});this.isDrawing=!1,this.interval=setInterval(t(function(t){return t.update(),!1},this),1e3/60)},destroy:function(){clearInterval(this.interval)},strokeStart:function(t,e,n){this.mouseX=t,this.mouseY=e,this.context.strokeStyle="rgba("+n[0]+", "+n[1]+", "+n[2]+", 0.05 )";for(var i=0;i<this.painters.length;i++)this.painters[i].dx=t,this.painters[i].dy=e;this.shouldDraw=!0},stroke:function(t,e){this.mouseX=t,this.mouseY=e},strokeEnd:function(){},update:function(){var t;for(t=0;t<this.painters.length;t++)this.context.beginPath(),this.context.moveTo(this.painters[t].dx,this.painters[t].dy),this.painters[t].dx-=this.painters[t].ax=(this.painters[t].ax+(this.painters[t].dx-this.mouseX)*this.painters[t].div)*this.painters[t].ease,this.painters[t].dy-=this.painters[t].ay=(this.painters[t].ay+(this.painters[t].dy-this.mouseY)*this.painters[t].div)*this.painters[t].ease,this.context.lineTo(this.painters[t].dx,this.painters[t].dy),this.context.stroke()}}}(),function(){e=function(e){var r,s,u,c,d;e=e||{};var l=function(){a=e.width?e.width:n.innerWidth,h=e.height?e.height:n.innerHeight,savecanvas=i.createElement("canvas"),savecanvas.width=u.width,savecanvas.height=u.height,savecanvas.getContext("2d").drawImage(u,0,0),u.width=a,u.height=h,d.drawImage(savecanvas,0,0),r=o(e.brush,d)},p=function(t){r.strokeEnd(),n.removeEventListener("mousemove",v,!1),n.removeEventListener("mouseup",p,!1)},v=function(i){var o,s=v.pts,a=e.offset.top-t(n).scrollTop(),h=i.clientX,u=i.clientY,c=i.target;c.parentNode;return h=e.offset?h-e.offset.left:h,u-=a,r.isStroking?(v.lastMove&&i.timeStamp-v.lastMove>300&&(s&&s.length?(n.DollarRecognizer&&(o=Rcgnzr.Recognize(s),"star"==o.Name&&o.Score>=.6&&n.starryEgg&&starryEgg()),v.pts=[]):v.pts=[]),v.lastMove=+i.timeStamp,n.Point&&s&&(s[s.length]=new Point(h,u)),console.log(e.color),void r.stroke(h,u,e.color)):(r.strokeStart(i.clientX,i.clientY,e.color),r.isStroking=!0,void(n.DollarRecognizer&&(n.Rcgnzr=new DollarRecognizer)))},g=function(t){1==t.touches.length&&(t.preventDefault(),r.strokeStart(t.touches[0].pageX,t.touches[0].pageY,e.color),n.addEventListener("touchmove",f,!1),n.addEventListener("touchend",m,!1))},f=function(t){1==t.touches.length&&(t.preventDefault(),r.stroke(t.touches[0].pageX,t.touches[0].pageY,e.color))},m=function(t){0==t.touches.length&&(t.preventDefault(),r.strokeEnd(),n.removeEventListener("touchmove",f,!1),n.removeEventListener("touchend",m,!1))};if(s=i.createElement("div"),e.appendTo&&e.appendTo instanceof jQuery?e.appendTo.append(s):i.body.appendChild(s),u=i.createElement("canvas"),u.width=e.width?e.width:a,u.height=e.height?e.height:h,u.style.cursor="crosshair",s.appendChild(u),u.getContext)return d=u.getContext("2d"),c=i.createElement("canvas"),c.width=e.width?e.width:a,c.height=e.height?e.height:h,r||(r=o("ribbon",d)),e.preventResize||n.addEventListener("resize",l,!1),i.addEventListener("mouseout",p,!1),u.addEventListener("mousemove",v,!1),u.addEventListener("touchstart",g,!1),l(e),u}}()}(this,this.document),t.fn.harmony=function(r){return r=r||{},n()?this.each(function(){var n,o,s,a,h,u=t(this).css({position:"relative"});a=r.color?r.color:[0,0,0],h=r.brush?r.brush:"ribbon",n={color:u.attr("data-color")?u.attr("data-color").split(","):a,brush:u.attr("data-brush")?u.attr("data-brush"):h},o=t.extend({},t.fn.harmony.defaults,r,n),1===o.color.length&&(s=o.color[0],o.color=[i.toR(s),i.toG(s),i.toB(s)]),e({brush:o.brush,color:o.color,height:u.innerHeight(),width:u.innerWidth(),offset:u.offset(),preventResize:!0,appendTo:u})}):this},t.fn.harmony.defaults={color:[0,0,0],brush:"ribbon"}}(jQuery);